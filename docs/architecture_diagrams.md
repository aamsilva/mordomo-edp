# Mordomo 3.0 - Arquitetura Single Agent vs Multi-Agent

## ğŸ›ï¸ ARQUITETURA 1: SINGLE AGENT (Legacy)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     UTILIZADOR EDP                          â”‚
â”‚              "Tenho uma avaria e quero fatura"              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CHATBOT EDP (Ãšnico)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  BillingAgent                                       â”‚   â”‚
â”‚  â”‚  â€¢ get_invoice()                                    â”‚   â”‚
â”‚  â”‚  â€¢ get_consumption()                                â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  âŒ NÃ£o sabe sobre avarias                          â”‚   â”‚
â”‚  â”‚  âŒ NÃ£o sabe sobre tÃ©cnicos                         â”‚   â”‚
â”‚  â”‚  âŒ NÃ£o sabe sobre rede elÃ©trica                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      RESPOSTA                               â”‚
â”‚     "Desculpe, sÃ³ posso ajudar com faturas."                â”‚
â”‚                      âŒ FRACASSO                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Problemas Single Agent:
- âŒ **Scope limitado** â€” sÃ³ sabe do que foi programado
- âŒ **NÃ£o escala** â€” adicionar funcionalidades requer rewrite
- âŒ **ExperiÃªncia pobre** â€” utilizador tem de saber o que perguntar
- âŒ **ManutenÃ§Ã£o difÃ­cil** â€” cÃ³digo monolÃ­tico, complexo

---

## ğŸ›ï¸ ARQUITETURA 2: MULTI-AGENT (Mordomo 3.0)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     UTILIZADOR EDP                          â”‚
â”‚              "Tenho uma avaria e quero fatura"              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ§  GATEWAY MCP â€” ORQUESTRADOR                  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  INTENT CLASSIFIER                                  â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  "fatura" + "valor"  â†’  [BILLING]                   â”‚   â”‚
â”‚  â”‚  "avaria" + "luz"    â†’  [SUPPORT]                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                   â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚           â–¼             â–¼             â–¼                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚             â”‚             â”‚
            â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”· BILLING    â”‚ â”‚ ğŸ”· SUPPORT    â”‚ â”‚ ğŸ”· GRID       â”‚
â”‚    AGENT      â”‚ â”‚    AGENT      â”‚ â”‚    AGENT      â”‚
â”‚               â”‚ â”‚               â”‚ â”‚               â”‚
â”‚ â€¢ Faturas     â”‚ â”‚ â€¢ Avarias     â”‚ â”‚ â€¢ TÃ©cnicos    â”‚
â”‚ â€¢ Consumo     â”‚ â”‚ â€¢ LigaÃ§Ãµes    â”‚ â”‚ â€¢ Rede        â”‚
â”‚ â€¢ Pagamentos  â”‚ â”‚ â€¢ EmergÃªncias â”‚ â”‚ â€¢ Cortes      â”‚
â”‚               â”‚ â”‚               â”‚ â”‚               â”‚
â”‚ Response:     â”‚ â”‚ Response:     â”‚ â”‚ Response:     â”‚
â”‚ "Fatura:      â”‚ â”‚ "Ticket:      â”‚ â”‚ "TÃ©cnico:     â”‚
â”‚  â‚¬127,50"     â”‚ â”‚  TKT-001"     â”‚ â”‚  14h"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚             â”‚             â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              RESPOSTA UNIFICADA AO UTILIZADOR               â”‚
â”‚                                                             â”‚
â”‚  ğŸ’° Fatura de janeiro: â‚¬127,50 (vencimento: 05/02)         â”‚
â”‚  ğŸ”§ Avaria registada â€” Ticket TKT-001                       â”‚
â”‚  ğŸ‘· TÃ©cnico agendado para hoje Ã s 14:00                     â”‚
â”‚                                                             â”‚
â”‚                      âœ… SUCESSO                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Vantagens Multi-Agent:
- âœ… **Escalabilidade** â€” adicionar agents sem tocar nos existentes
- âœ… **EspecializaÃ§Ã£o** â€” cada agent Ã© expert no seu domÃ­nio
- âœ… **ResiliÃªncia** â€” falha num agent nÃ£o afeta os outros
- âœ… **ManutenÃ§Ã£o** â€” cÃ³digo modular, fÃ¡cil de atualizar

---

## ğŸ“Š COMPARAÃ‡ÃƒO VISUAL

### Adicionar Novo Agente

#### Single Agent (âŒ)
```
Antes: [BillingAgent] â€” 500 linhas

Adicionar Support:
â”œâ”€ Editar BillingAgent
â”œâ”€ Adicionar if/else para suporte
â”œâ”€ Testar tudo (billing + suporte)
â”œâ”€ Risco: quebrar funcionalidade existente
â””â”€ Tempo: 2-3 dias
```

#### Multi-Agent (âœ…)
```
Antes: [BillingAgent] [SupportAgent]

Adicionar GridAgent:
â”œâ”€ Criar grid_agent.py â€” 50 linhas
â”œâ”€ Registar no gateway â€” 1 linha
â”œâ”€ Testar sÃ³ o novo agent
â”œâ”€ Zero impacto nos existentes
â””â”€ Tempo: 30 minutos
```

---

## ğŸ”§ FLUXO DE DADOS DETALHADO

### 1. Receber Pedido
```
User: "Avaria no contador e quero fatura"
        â†“
Gateway: AnÃ¡lise de intenÃ§Ã£o
        â†“
Keywords: ["avaria", "contador", "fatura"]
```

### 2. Route para Agents
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         INTENT ROUTER               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ "fatura" â†’ BILLING (confianÃ§a: 95%) â”‚
â”‚ "avaria" â†’ SUPPORT (confianÃ§a: 98%) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    Executar ambos em paralelo
```

### 3. Agregar Respostas
```
BillingAgent â†’ {"fatura": "â‚¬127,50"}
SupportAgent â†’ {"ticket": "TKT-001", "status": "aberto"}
        â†“
Gateway: Merge + FormataÃ§Ã£o
        â†“
Resposta final ao utilizador
```

---

## ğŸ¯ DIAGRAMA PARA SLIDE EDP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MORDOMO 3.0                             â”‚
â”‚              Arquitetura Multi-Agente                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚   USER â”€â”€â–º GATEWAY â”€â”€â”¬â”€â”€â–º BILLING AGENT  (Faturas)        â”‚
â”‚    â”‚      (Router)   â”œâ”€â”€â–º SUPPORT AGENT  (Avarias)        â”‚
â”‚    â”‚                 â””â”€â”€â–º GRID AGENT     (TÃ©cnicos)       â”‚
â”‚    â”‚                        â†“                              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AGREGADOR â”€â”€â–º RESPOSTA            â”‚
â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸš€ Adicionar novo agente: 10 linhas de cÃ³digo            â”‚
â”‚  ğŸ”’ Zero downtime, zero breaking changes                   â”‚
â”‚  âš¡ Resposta < 2 segundos                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ EVOLUÃ‡ÃƒO DA ARQUITETURA

```
VERSÃƒO 1.0 (Hoje)          VERSÃƒO 2.0 (PrÃ³ximo mÃªs)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BILLING    â”‚            â”‚  BILLING    â”‚
â”‚  SUPPORT    â”‚     â†’      â”‚  SUPPORT    â”‚
â”‚             â”‚            â”‚  GRID       â”‚
â”‚             â”‚            â”‚  SOLAR      â”‚  â—„â”€â”€ Novo
â”‚             â”‚            â”‚  EV         â”‚  â—„â”€â”€ Novo
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     2 Agents                   5 Agents
   (30 min setup)            (mesma base)
```

**Mensagem chave:** "Escalabilidade sem rewrites"

---

## ğŸ¨ CORES PARA DIAGRAMA (se usar Figma/Draw.io)

- **Gateway:** `#667eea` (Roxo â€” orquestrador central)
- **Billing Agent:** `#10b981` (Verde â€” dinheiro/faturas)
- **Support Agent:** `#f59e0b` (Laranja â€” alertas/avarias)
- **Grid